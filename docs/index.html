<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>M.A.S.S. Trap ‚Äî Forensic-Grade Physics Lab for $7</title>
<meta name="description" content="Turn a Hot Wheels track into a forensic-grade physics laboratory. Microsecond timing, evidence chain of custody, and a full web dashboard ‚Äî all on a $7 ESP32.">
<meta name="keywords" content="ESP32, Hot Wheels, physics, science fair, speed trap, STEM, maker, DIY">
<meta property="og:title" content="M.A.S.S. Trap ‚Äî Motion Analysis & Speed System">
<meta property="og:description" content="A forensic-grade physics lab disguised as a Hot Wheels speedometer. Built by a dad and his kids.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://ryan4n6.github.io/MASS-Trap/">
<link rel="canonical" href="https://ryan4n6.github.io/MASS-Trap/">
<style>
/* ============================================================
   M.A.S.S. Trap ‚Äî GitHub Pages
   Design language: Navy + Gold (Judge Dredd shield palette)
   ============================================================ */
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --navy:#091B2F;--navy-light:#0d2847;--navy-mid:#112d4e;--navy-card:#0f2340;
  --gold:#D4AF37;--gold-dim:rgba(212,175,55,0.25);--gold-glow:rgba(212,175,55,0.08);
  --orange:#FF4500;--orange-dim:rgba(255,69,0,0.15);
  --text:#E8E8E8;--text-muted:#8899AA;--text-dim:#556677;
  --green:#28a745;--red:#dc3545;--cyan:#17a2b8;
  --font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  --mono:"SF Mono",Monaco,"Cascadia Code","Fira Code",monospace;
  --max-w:1100px;
  --radius:12px;
}
html{scroll-behavior:smooth}
body{background:var(--navy);color:var(--text);font-family:var(--font);line-height:1.7;-webkit-font-smoothing:antialiased}
a{color:var(--gold);text-decoration:none;transition:color 0.2s}
a:hover{color:#e8c84a;text-decoration:underline}
img{max-width:100%;height:auto}
.container{max-width:var(--max-w);margin:0 auto;padding:0 20px}

/* === HERO === */
.hero{text-align:center;padding:80px 20px 60px;position:relative;overflow:hidden}
.hero::before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(ellipse at center,var(--gold-glow) 0%,transparent 70%);pointer-events:none}
.hero-badge{display:inline-block;background:var(--gold);color:var(--navy);font-size:0.65rem;font-weight:800;padding:4px 16px;border-radius:20px;text-transform:uppercase;letter-spacing:2px;margin-bottom:20px}
.hero h1{font-size:3.5rem;color:var(--gold);letter-spacing:4px;font-weight:900;line-height:1.1;margin-bottom:8px}
.hero h1 span{display:block;font-size:1rem;color:var(--text-muted);letter-spacing:6px;font-weight:400;margin-top:8px}
.hero-tagline{font-size:1.15rem;color:var(--text-muted);max-width:640px;margin:16px auto 0;line-height:1.8}
.hero-tagline strong{color:var(--text)}
.hero-tagline em{color:var(--gold);font-style:normal}
.hero-cta{margin-top:36px;display:flex;gap:16px;justify-content:center;flex-wrap:wrap}
.btn{display:inline-flex;align-items:center;gap:8px;padding:14px 28px;border-radius:8px;font-weight:700;font-size:0.95rem;letter-spacing:0.5px;transition:all 0.2s;border:none;cursor:pointer;text-decoration:none}
.btn:hover{text-decoration:none;transform:translateY(-1px)}
.btn-gold{background:var(--gold);color:var(--navy)}
.btn-gold:hover{background:#e8c84a;color:var(--navy)}
.btn-outline{background:transparent;color:var(--gold);border:2px solid var(--gold)}
.btn-outline:hover{background:var(--gold-glow);color:var(--gold)}
.btn-orange{background:var(--orange);color:white}
.btn-orange:hover{background:#ff5a1f}
@media(max-width:600px){.hero h1{font-size:2.2rem;letter-spacing:2px}.hero{padding:50px 16px 40px}.hero-cta{flex-direction:column;align-items:center}}

/* === STATS BANNER === */
.stats-banner{background:var(--navy-light);border-top:1px solid var(--gold-dim);border-bottom:1px solid var(--gold-dim);padding:24px 0}
.stats-row{display:flex;justify-content:center;gap:40px;flex-wrap:wrap}
.stat{text-align:center}
.stat-val{font-size:1.6rem;font-weight:800;color:var(--gold);font-family:var(--mono)}
.stat-lbl{font-size:0.65rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:1.5px;margin-top:2px}
@media(max-width:600px){.stats-row{gap:20px}.stat-val{font-size:1.2rem}}

/* === SECTIONS === */
.section{padding:80px 0}
.section:nth-child(even){background:var(--navy-light)}
.section-header{text-align:center;margin-bottom:48px}
.section-header h2{font-size:2rem;color:var(--gold);letter-spacing:2px;margin-bottom:8px}
.section-header p{color:var(--text-muted);font-size:1rem;max-width:600px;margin:0 auto}
@media(max-width:600px){.section{padding:50px 0}.section-header h2{font-size:1.5rem}}

/* === FEATURE CARDS === */
.features-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}
.feature-card{background:var(--navy-card);border:1px solid var(--gold-dim);border-radius:var(--radius);padding:28px 24px;transition:border-color 0.3s,transform 0.2s}
.feature-card:hover{border-color:var(--gold);transform:translateY(-2px)}
.feature-icon{font-size:2rem;margin-bottom:12px}
.feature-card h3{color:var(--text);font-size:1.05rem;margin-bottom:6px}
.feature-card p{color:var(--text-muted);font-size:0.88rem;line-height:1.6}

/* === BUILD TIERS === */
.tiers-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:24px}
.tier-card{background:var(--navy-card);border:2px solid var(--gold-dim);border-radius:var(--radius);overflow:hidden;transition:border-color 0.3s,transform 0.2s}
.tier-card:hover{border-color:var(--gold);transform:translateY(-3px)}
.tier-card.recommended{border-color:var(--gold)}
.tier-header{padding:24px 20px 16px;text-align:center;border-bottom:1px solid var(--gold-dim)}
.tier-badge{display:inline-block;background:var(--gold);color:var(--navy);font-size:0.6rem;font-weight:800;padding:3px 10px;border-radius:10px;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px}
.tier-name{font-size:1.3rem;color:var(--text);font-weight:700}
.tier-price{font-size:2rem;color:var(--gold);font-weight:900;font-family:var(--mono);margin:8px 0 4px}
.tier-price span{font-size:0.8rem;color:var(--text-muted);font-weight:400}
.tier-desc{font-size:0.82rem;color:var(--text-muted)}
.tier-body{padding:20px}
.tier-list{list-style:none;padding:0}
.tier-list li{padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.04);font-size:0.88rem;color:var(--text-muted);display:flex;align-items:flex-start;gap:8px}
.tier-list li:last-child{border-bottom:none}
.tier-list li::before{content:"";flex-shrink:0;width:6px;height:6px;background:var(--gold);border-radius:50%;margin-top:8px}
.tier-list li strong{color:var(--text)}
.tier-footer{padding:16px 20px;border-top:1px solid var(--gold-dim);text-align:center}

/* === COMING SOON === */
.coming-soon{background:var(--navy-card);border:2px dashed var(--gold-dim);border-radius:var(--radius);padding:48px 32px;text-align:center;max-width:700px;margin:0 auto}
.coming-soon h3{color:var(--gold);font-size:1.3rem;margin-bottom:8px}
.coming-soon p{color:var(--text-muted);font-size:0.92rem}
.coming-soon .emoji{font-size:3rem;margin-bottom:16px}

/* === ROADMAP === */
.roadmap{max-width:700px;margin:0 auto}
.roadmap-item{display:flex;gap:20px;padding:16px 0;border-bottom:1px solid rgba(255,255,255,0.04)}
.roadmap-item:last-child{border-bottom:none}
.roadmap-status{flex-shrink:0;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.9rem;margin-top:2px}
.roadmap-status.done{background:rgba(40,167,69,0.2);border:1px solid var(--green)}
.roadmap-status.wip{background:var(--orange-dim);border:1px solid var(--orange)}
.roadmap-status.planned{background:var(--gold-glow);border:1px solid var(--gold-dim)}
.roadmap-item h4{color:var(--text);font-size:0.95rem;margin-bottom:2px}
.roadmap-item p{color:var(--text-muted);font-size:0.82rem}

/* === QUOTE === */
.quote-block{background:linear-gradient(135deg,var(--navy-card),var(--navy-mid));border:2px solid var(--gold);border-radius:var(--radius);padding:32px;text-align:center;max-width:700px;margin:0 auto}
.quote-block blockquote{font-size:1.1rem;color:var(--cyan);font-style:italic;line-height:1.7}
.quote-block cite{display:block;margin-top:12px;color:var(--text-muted);font-size:0.85rem;font-style:normal}

/* === FOOTER === */
.site-footer{background:var(--navy-light);border-top:1px solid var(--gold-dim);padding:40px 0;text-align:center}
.footer-links{display:flex;justify-content:center;gap:24px;flex-wrap:wrap;margin-bottom:16px}
.footer-links a{color:var(--text-muted);font-size:0.85rem}
.footer-links a:hover{color:var(--gold)}
.footer-copy{color:var(--text-dim);font-size:0.75rem}
.footer-copy a{color:var(--text-muted)}

/* === POPUP TIPS (VH1 Pop-Up Video style) === */
.tip-bubble{position:relative;background:var(--navy-card);border:1px solid var(--gold);border-radius:10px;padding:16px 20px;margin:20px 0;font-size:0.88rem;color:var(--text-muted);line-height:1.6}
.tip-bubble::before{content:"";position:absolute;top:-8px;left:24px;width:16px;height:16px;background:var(--navy-card);border-left:1px solid var(--gold);border-top:1px solid var(--gold);transform:rotate(45deg)}
.tip-label{display:inline-block;background:var(--gold);color:var(--navy);font-size:0.6rem;font-weight:800;padding:2px 8px;border-radius:4px;text-transform:uppercase;letter-spacing:1px;margin-bottom:6px}
.tip-bubble strong{color:var(--text)}
.tip-bubble em{color:var(--cyan);font-style:normal}

/* === AFFILIATE NOTICE === */
.affiliate-notice{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.06);border-radius:8px;padding:12px 16px;font-size:0.75rem;color:var(--text-dim);text-align:center;margin-top:24px}
</style>
</head>
<body>

<!-- ==================== HERO ==================== -->
<div class="hero">
  <div class="hero-badge">Open Source &bull; Built by a Dad &bull; Powered by ESP32</div>
  <h1>M.A.S.S. TRAP<span>Motion Analysis &amp; Speed System</span></h1>
  <p class="hero-tagline">
    A <em>forensic-grade physics laboratory</em> disguised as a Hot Wheels track speedometer.
    <strong>Microsecond timing. Evidence chain of custody. Full web dashboard.</strong>
    All running on a <em>$7 microcontroller</em>.
  </p>
  <div class="hero-cta">
    <a href="#demo" class="btn btn-orange">&#x1F3AE; Try the Live Demo</a>
    <a href="#build" class="btn btn-gold">Build One</a>
    <a href="https://github.com/Ryan4n6/MASS-Trap" class="btn btn-outline" target="_blank">View on GitHub</a>
    <a href="https://github.com/Ryan4n6/MASS-Trap/releases/latest" class="btn btn-outline" target="_blank">Download Firmware</a>
  </div>
</div>

<!-- ==================== STATS BANNER ==================== -->
<div class="stats-banner">
  <div class="stats-row">
    <div class="stat"><div class="stat-val">21,500+</div><div class="stat-lbl">Lines of Code</div></div>
    <div class="stat"><div class="stat-val">$7</div><div class="stat-lbl">Hardware Cost</div></div>
    <div class="stat"><div class="stat-val">&micro;s</div><div class="stat-lbl">Timing Precision</div></div>
    <div class="stat"><div class="stat-val">25+</div><div class="stat-lbl">API Endpoints</div></div>
    <div class="stat"><div class="stat-val">0</div><div class="stat-lbl">Frameworks Used</div></div>
  </div>
</div>

<!-- ==================== WHAT IS IT ==================== -->
<div class="section">
  <div class="container">
    <div class="section-header">
      <h2>What Is This Thing?</h2>
      <p>Everything you need to run a real physics experiment with toy cars.</p>
    </div>
    <div class="features-grid">
      <div class="feature-card">
        <div class="feature-icon">&#9201;</div>
        <h3>Microsecond Race Timing</h3>
        <p>Hardware interrupt-driven timing on dual-core ESP32-S3. IR break-beam sensors at start and finish. No polling, no missed events, no excuses.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">&#128202;</div>
        <h3>Full Physics Dashboard</h3>
        <p>Speed, velocity, momentum, kinetic energy &mdash; calculated in real-time and served over WiFi. Five visual themes. Works on any browser.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">&#128274;</div>
        <h3>Evidence Chain of Custody</h3>
        <p>Every race gets a case number, QR-coded evidence tag, and printable label. NFC stickers auto-identify cars. Forensic-grade data logging.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">&#127891;</div>
        <h3>Science Fair Mode</h3>
        <p>Guided 6-phase testing workflow. Define variables, intake vehicles, assign case numbers, collect data, generate reports. One button = full submission.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">&#128225;</div>
        <h3>ESP-NOW Mesh Network</h3>
        <p>Up to 3 devices communicate wirelessly: start gate, finish gate, and mid-track speed trap. Microsecond-synced clocks. Auto-discovery.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">&#127911;</div>
        <h3>Audio Announcer</h3>
        <p>Built-in I2S audio calls out race results, car names, and speed records through a speaker. Your track talks back. No external apps needed.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">&#128161;</div>
        <h3>WLED LED Integration</h3>
        <p>Sync addressable LED strips to race state. Armed = breathing blue. Racing = chase animation. Finish = celebration burst. 1000+ LEDs supported.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">&#128241;</div>
        <h3>NFC + LiDAR + OTA</h3>
        <p>NFC stickers on cars for auto-identification. TF-Luna LiDAR for auto-arming. Browser-based firmware updates. No cables needed after first flash.</p>
      </div>
    </div>

    <div class="tip-bubble" style="max-width:700px;margin:32px auto 0">
      <div class="tip-label">Ryan Says</div>
      This started as a weekend project for my son's science fair. Two months and 21,000 lines of code later, it's a full forensic physics lab that runs on hardware cheaper than the Hot Wheels cars it measures. <strong>If a 10-year-old can operate it, so can you.</strong>
    </div>
  </div>
</div>

<!-- ==================== LIVE DASHBOARD DEMO ==================== -->
<div class="section" id="demo">
  <div class="container">
    <div class="section-header">
      <h2>Live Dashboard Preview</h2>
      <p>This is the actual dashboard UI. No hardware needed &mdash; watch it run a simulated race.</p>
    </div>

    <!-- Dashboard Container (scoped styles) -->
    <div id="demoFrame" class="demo-frame" data-theme="interceptor">

      <!-- Demo Controls Bar -->
      <div class="demo-controls">
        <div class="demo-badge">&#x1F6A8; DEMO MODE</div>
        <div class="demo-theme-pick">
          <label for="demoTheme" style="font-size:0.7rem;color:var(--d-muted);">Theme:</label>
          <select id="demoTheme" onchange="demoSetTheme(this.value)">
            <option value="interceptor">Interceptor</option>
            <option value="classic">Classic</option>
            <option value="daytona">Daytona</option>
            <option value="casefile">Case File</option>
            <option value="cyber">Cyber</option>
          </select>
        </div>
      </div>

      <!-- Header -->
      <div class="demo-header">
        <div class="demo-shield" aria-hidden="true"></div>
        <h3 id="demoTitle">M.A.S.S. TRAP</h3>
        <div id="demoSubtitle" class="demo-subtitle">MOTION ANALYSIS &amp; SPEED SYSTEM</div>
        <div id="demoTagline" class="demo-tagline">COMMAND CENTER</div>
      </div>

      <!-- Connection Badge -->
      <div id="demoConn" class="demo-conn connected">LINKED</div>

      <!-- State Banner -->
      <div id="demoBanner" class="demo-state-banner idle">AWAITING SUSPECTS</div>

      <!-- LED Bar -->
      <div id="demoLed" class="demo-led-bar idle" aria-hidden="true"></div>

      <!-- Quick Actions -->
      <div class="demo-grid demo-grid-3">
        <button id="demoBtnArm" class="demo-btn demo-btn-success" onclick="demoArm()">ARM SYSTEM</button>
        <button class="demo-btn demo-btn-accent" onclick="demoReset()">RESET</button>
        <button class="demo-btn demo-btn-primary" onclick="demoSync()">SYNC CLOCK</button>
      </div>

      <!-- Live Stats -->
      <div class="demo-grid demo-grid-3">
        <div class="demo-card">
          <div class="demo-card-label">Time</div>
          <div><span id="demoTime" class="demo-card-value">--</span><span class="demo-card-unit">s</span></div>
        </div>
        <div class="demo-card">
          <div class="demo-card-label">Real Speed</div>
          <div><span id="demoSpeed" class="demo-card-value">--</span><span class="demo-card-unit">mph</span></div>
        </div>
        <div class="demo-card demo-card-accent">
          <div class="demo-card-label">Scale Speed (1:64)</div>
          <div><span id="demoScale" class="demo-card-value">--</span><span class="demo-card-unit">mph</span></div>
        </div>
      </div>

      <!-- Physics -->
      <div class="demo-grid demo-grid-3">
        <div class="demo-card">
          <div class="demo-card-label">Momentum</div>
          <div><span id="demoMomentum" class="demo-card-value">--</span><span class="demo-card-unit">kg&middot;m/s</span></div>
        </div>
        <div class="demo-card">
          <div class="demo-card-label">Kinetic Energy</div>
          <div><span id="demoKE" class="demo-card-value">--</span><span class="demo-card-unit">J</span></div>
        </div>
        <div class="demo-card">
          <div class="demo-card-label">Total Runs</div>
          <div><span id="demoRuns" class="demo-card-value">0</span></div>
        </div>
      </div>

      <!-- Most Wanted Leaderboard -->
      <div class="demo-section">
        <div class="demo-section-title">MOST WANTED</div>
        <div id="demoMW" class="demo-mw-board">
          <div class="demo-mw-empty">Waiting for race data...</div>
        </div>
      </div>

      <!-- Case File History -->
      <div class="demo-section">
        <div class="demo-section-title">CASE FILE</div>
        <div style="overflow-x:auto;">
          <table class="demo-table">
            <thead><tr><th>Run</th><th>Suspect</th><th>Mass</th><th>Time</th><th>Real MPH</th><th>Scale MPH</th><th>Momentum</th><th>KE</th></tr></thead>
            <tbody id="demoHistory"><tr><td colspan="8" style="text-align:center;color:var(--d-muted);padding:20px;">No evidence recorded yet</td></tr></tbody>
          </table>
        </div>
      </div>

      <!-- ============================================= -->
      <!--  FEATURE 1: EVIDENCE TAG (pops up after race) -->
      <!-- ============================================= -->
      <div id="demoEvTag" class="demo-ev-tag" style="display:none;">
        <div class="demo-ev-tag-inner">
          <div class="demo-ev-tag-header">
            <div class="demo-ev-tag-badge">EVIDENCE TAG</div>
            <button class="demo-ev-tag-close" onclick="demoCloseTag()" aria-label="Close">&times;</button>
          </div>
          <div class="demo-ev-tag-body">
            <div class="demo-ev-tag-row">
              <div class="demo-ev-tag-qr" id="demoEvQr"></div>
              <div class="demo-ev-tag-info">
                <div class="demo-ev-tag-case" id="demoEvCase">MASS26-0001</div>
                <div class="demo-ev-tag-detail" id="demoEvDetail">--</div>
              </div>
            </div>
            <div class="demo-ev-tag-meta" id="demoEvMeta">--</div>
          </div>
        </div>
      </div>

      <!-- ============================================= -->
      <!--  FEATURE 2: SCIENCE FAIR 6-PHASE STEPPER      -->
      <!-- ============================================= -->
      <div class="demo-section">
        <div class="demo-section-title">SCIENCE FAIR MODE</div>
        <div class="demo-sf-stepper" id="demoStepper">
          <div class="demo-sf-step completed" data-phase="1">
            <div class="demo-sf-dot">&#10003;</div>
            <div class="demo-sf-label">Setup</div>
          </div>
          <div class="demo-sf-line completed"></div>
          <div class="demo-sf-step completed" data-phase="2">
            <div class="demo-sf-dot">&#10003;</div>
            <div class="demo-sf-label">Intake</div>
          </div>
          <div class="demo-sf-line completed"></div>
          <div class="demo-sf-step completed" data-phase="3">
            <div class="demo-sf-dot">&#10003;</div>
            <div class="demo-sf-label">Evidence</div>
          </div>
          <div class="demo-sf-line completed"></div>
          <div class="demo-sf-step completed" data-phase="4">
            <div class="demo-sf-dot">&#10003;</div>
            <div class="demo-sf-label">Pre-Flight</div>
          </div>
          <div class="demo-sf-line active"></div>
          <div class="demo-sf-step active" data-phase="5">
            <div class="demo-sf-dot">5</div>
            <div class="demo-sf-label">Collect</div>
          </div>
          <div class="demo-sf-line"></div>
          <div class="demo-sf-step" data-phase="6">
            <div class="demo-sf-dot">6</div>
            <div class="demo-sf-label">Results</div>
          </div>
        </div>
        <div class="demo-sf-info" id="demoSfInfo">
          <div class="demo-sf-status">&#9654; PHASE 5: DATA COLLECTION</div>
          <div class="demo-sf-desc">Collecting race data with sanity checks. Auto-advancing through test matrix.</div>
          <div class="demo-sf-progress">
            <div class="demo-sf-bar-bg">
              <div class="demo-sf-bar-fill" id="demoSfBar" style="width:0%"></div>
            </div>
            <div class="demo-sf-bar-label" id="demoSfBarLabel">Run 0 of 20</div>
          </div>
        </div>
      </div>

      <!-- ============================================= -->
      <!--  FEATURE 3: THE GARAGE (interactive car grid) -->
      <!-- ============================================= -->
      <div class="demo-section">
        <div class="demo-section-title">THE GARAGE</div>
        <div class="demo-garage" id="demoGarage"></div>
        <div class="demo-garage-hint">Click a car to select it for the next race</div>
      </div>

      <!-- ============================================= -->
      <!--  FEATURE 4: FORENSIC ANALYSIS FORMULA CARDS   -->
      <!-- ============================================= -->
      <div class="demo-section">
        <div class="demo-section-title">FORENSIC ANALYSIS</div>
        <div class="demo-grid demo-grid-4" id="demoFormulas">
          <div class="demo-formula-card">
            <div class="demo-formula-eq">v = d / t</div>
            <div class="demo-formula-name">Velocity</div>
            <div class="demo-formula-val" id="demoFVel">-- m/s</div>
            <div class="demo-formula-work" id="demoFVelWork">6.01m &divide; --s</div>
          </div>
          <div class="demo-formula-card">
            <div class="demo-formula-eq">p = m &times; v</div>
            <div class="demo-formula-name">Momentum</div>
            <div class="demo-formula-val" id="demoFMom">-- kg&middot;m/s</div>
            <div class="demo-formula-work" id="demoFMomWork">--kg &times; --m/s</div>
          </div>
          <div class="demo-formula-card">
            <div class="demo-formula-eq">KE = &frac12;mv&sup2;</div>
            <div class="demo-formula-name">Kinetic Energy</div>
            <div class="demo-formula-val" id="demoFKE">-- J</div>
            <div class="demo-formula-work" id="demoFKEWork">&frac12; &times; --kg &times; --&sup2;</div>
          </div>
          <div class="demo-formula-card">
            <div class="demo-formula-eq">a = v / t</div>
            <div class="demo-formula-name">Acceleration</div>
            <div class="demo-formula-val" id="demoFAcc">-- m/s&sup2;</div>
            <div class="demo-formula-work" id="demoFAccWork">--m/s &divide; --s</div>
          </div>
        </div>
      </div>

      <!-- ============================================= -->
      <!--  FEATURE 5: GHOST CAR COMPARISON               -->
      <!-- ============================================= -->
      <div id="demoGhost" class="demo-ghost" style="display:none;">
        <div class="demo-ghost-inner">
          <div class="demo-ghost-icon" id="demoGhostIcon">&#128123;</div>
          <div class="demo-ghost-label">VS PERSONAL BEST</div>
          <div class="demo-ghost-delta" id="demoGhostDelta">--</div>
          <div class="demo-ghost-detail" id="demoGhostDetail">--</div>
        </div>
      </div>

      <!-- Version Badge -->
      <div class="demo-version">FW v2.6.0-beta</div>
    </div>

    <div class="tip-bubble" style="max-width:700px;margin:32px auto 0">
      <div class="tip-label">What You're Seeing</div>
      This is a <strong>fully interactive simulation</strong> of the real dashboard served by the ESP32. The actual system uses WebSocket for real-time data &mdash; this demo runs the same UI with simulated race data. <em>Click ARM to run a race manually, or just watch it auto-cycle.</em>
    </div>
  </div>
</div>

<style>
/* =============================================================
   LIVE DASHBOARD DEMO ‚Äî Scoped inside #demoFrame
   Each theme sets CSS variables via [data-theme] on #demoFrame
   ============================================================= */
#demoFrame{position:relative;border-radius:var(--radius);overflow:hidden;max-width:900px;margin:0 auto;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif}

/* --- THEME VARIABLES (mirrors firmware style.css) --- */
#demoFrame[data-theme="interceptor"]{--d-bg:#1a1a2e;--d-card:#16213e;--d-dark:#0f0f1e;--d-border:#2a2a4a;--d-accent:#d4af37;--d-accent-rgb:212,175,55;--d-secondary:#4a90d9;--d-secondary-rgb:74,144,217;--d-success:#28a745;--d-danger:#dc3545;--d-text:#e0e0e0;--d-muted:#8888aa;--d-font-data:'Courier New',monospace;background:var(--d-bg);border:2px solid var(--d-accent);color:var(--d-text)}
#demoFrame[data-theme="classic"]{--d-bg:#FF4400;--d-card:#ffffff;--d-dark:#f0f0f0;--d-border:#007ACC;--d-accent:#FFCC00;--d-accent-rgb:255,204,0;--d-secondary:#007ACC;--d-secondary-rgb:0,122,204;--d-success:#28a745;--d-danger:#dc3545;--d-text:#333333;--d-muted:#666666;--d-font-data:'Courier New',monospace;background:var(--d-bg);border:2px solid var(--d-accent);color:var(--d-text)}
#demoFrame[data-theme="daytona"]{--d-bg:#141414;--d-card:#2a2a2a;--d-dark:#0e0e0e;--d-border:#555555;--d-accent:#ffcc00;--d-accent-rgb:255,204,0;--d-secondary:#ff0000;--d-secondary-rgb:255,0,0;--d-success:#00c853;--d-danger:#ff1744;--d-text:#f0f0f0;--d-muted:#999999;--d-font-data:'Courier New',monospace;background:var(--d-bg);border:2px solid var(--d-accent);color:var(--d-text);font-family:Impact,'Arial Narrow','Segoe UI',sans-serif}
#demoFrame[data-theme="casefile"]{--d-bg:#f4f0e8;--d-card:#fffdf5;--d-dark:#e8e2d4;--d-border:#c4b99a;--d-accent:#8b0000;--d-accent-rgb:139,0,0;--d-secondary:#1a472a;--d-secondary-rgb:26,71,42;--d-success:#28a745;--d-danger:#dc3545;--d-text:#2a2a2a;--d-muted:#666655;--d-font-data:'Courier New',monospace;background:var(--d-bg);border:2px solid var(--d-accent);color:var(--d-text)}
#demoFrame[data-theme="cyber"]{--d-bg:#0a0a14;--d-card:#111122;--d-dark:#050510;--d-border:#1a3a5a;--d-accent:#00ffcc;--d-accent-rgb:0,255,204;--d-secondary:#ff00ff;--d-secondary-rgb:255,0,255;--d-success:#00ff66;--d-danger:#ff0044;--d-text:#ccddee;--d-muted:#557799;--d-font-data:'Courier New',monospace;background:var(--d-bg);border:2px solid var(--d-accent);color:var(--d-text)}

/* --- CONTROLS BAR --- */
.demo-controls{display:flex;align-items:center;justify-content:space-between;padding:8px 12px;background:rgba(0,0,0,0.3);border-bottom:1px solid var(--d-border)}
.demo-badge{font-size:0.65rem;font-weight:900;letter-spacing:1.5px;color:var(--d-danger);text-transform:uppercase;animation:demoPulse 2s ease-in-out infinite}
@keyframes demoPulse{0%,100%{opacity:1}50%{opacity:0.5}}
.demo-theme-pick{display:flex;align-items:center;gap:6px}
.demo-theme-pick select{background:var(--d-dark);color:var(--d-text);border:1px solid var(--d-border);border-radius:4px;padding:3px 6px;font-size:0.75rem}

/* --- HEADER --- */
.demo-header{text-align:center;padding:16px 12px 8px;position:relative}
.demo-shield{width:40px;height:40px;background:var(--d-accent);clip-path:polygon(50% 0%,100% 25%,100% 75%,50% 100%,0% 75%,0% 25%);margin:0 auto 8px;opacity:0.25}
.demo-header h3{font-size:1.6rem;color:var(--d-accent);letter-spacing:3px;font-weight:900;margin:0}
.demo-subtitle{font-size:0.6rem;color:var(--d-muted);letter-spacing:4px;text-transform:uppercase}
.demo-tagline{font-size:0.55rem;color:var(--d-accent);letter-spacing:6px;text-transform:uppercase;margin-top:2px;opacity:0.7}

/* --- CONNECTION BADGE --- */
.demo-conn{position:absolute;top:12px;right:12px;font-size:0.6rem;font-weight:900;padding:3px 10px;border-radius:20px;letter-spacing:1px}
.demo-conn.connected{background:rgba(40,167,69,0.2);color:var(--d-success);border:1px solid var(--d-success)}
.demo-conn.disconnected{background:rgba(220,53,69,0.2);color:var(--d-danger);border:1px solid var(--d-danger)}

/* --- STATE BANNER --- */
.demo-state-banner{text-align:center;font-size:1.3rem;font-weight:900;letter-spacing:4px;padding:12px;margin:8px 12px;border-radius:8px;transition:all 0.3s}
.demo-state-banner.idle{background:var(--d-card);color:var(--d-muted);border:1px solid var(--d-border)}
.demo-state-banner.armed{background:rgba(var(--d-accent-rgb),0.15);color:var(--d-accent);border:2px solid var(--d-accent);animation:demoArmedPulse 1.5s ease-in-out infinite}
@keyframes demoArmedPulse{0%,100%{box-shadow:0 0 0 0 rgba(var(--d-accent-rgb),0.4)}50%{box-shadow:0 0 20px 4px rgba(var(--d-accent-rgb),0.2)}}
.demo-state-banner.racing{background:rgba(var(--d-secondary-rgb),0.15);color:var(--d-secondary);border:2px solid var(--d-secondary);animation:demoRacePulse 0.5s ease-in-out infinite}
@keyframes demoRacePulse{0%,100%{opacity:1}50%{opacity:0.7}}
.demo-state-banner.finished{background:rgba(var(--d-success),0.15);color:var(--d-success);border:2px solid var(--d-success)}

/* --- LED BAR --- */
.demo-led-bar{height:4px;margin:0 12px;border-radius:2px;transition:all 0.3s}
.demo-led-bar.idle{background:linear-gradient(90deg,var(--d-border),var(--d-border))}
.demo-led-bar.armed{background:linear-gradient(90deg,var(--d-accent),transparent,var(--d-accent));animation:demoLedArmed 2s linear infinite}
@keyframes demoLedArmed{0%{background-position:0}100%{background-position:200px}}
.demo-led-bar.racing{background:linear-gradient(90deg,var(--d-secondary),var(--d-accent),var(--d-secondary));background-size:200px;animation:demoLedRace 0.4s linear infinite}
@keyframes demoLedRace{0%{background-position:0}100%{background-position:200px}}
.demo-led-bar.finished{background:linear-gradient(90deg,var(--d-success),var(--d-accent),var(--d-success));background-size:200px;animation:demoLedFinish 1s linear infinite}
@keyframes demoLedFinish{0%{background-position:0}100%{background-position:200px}}

/* --- BUTTONS --- */
.demo-btn{padding:8px 12px;border:none;border-radius:6px;font-weight:900;font-size:0.75rem;letter-spacing:1px;text-transform:uppercase;cursor:pointer;transition:all 0.2s}
.demo-btn:hover{transform:translateY(-1px);filter:brightness(1.1)}
.demo-btn:active{transform:translateY(0)}
.demo-btn-success{background:var(--d-success);color:#fff}
.demo-btn-accent{background:var(--d-accent);color:#000}
.demo-btn-primary{background:var(--d-secondary);color:#fff}

/* --- GRID --- */
.demo-grid{display:grid;gap:8px;padding:8px 12px}
.demo-grid-3{grid-template-columns:repeat(3,1fr)}
@media(max-width:500px){.demo-grid-3{grid-template-columns:1fr}}

/* --- CARDS --- */
.demo-card{background:var(--d-card);border:1px solid var(--d-border);border-radius:8px;padding:10px 12px;text-align:center}
.demo-card-accent{border-color:var(--d-accent);background:linear-gradient(135deg,var(--d-card),rgba(var(--d-accent-rgb),0.05))}
.demo-card-label{font-size:0.6rem;font-weight:700;color:var(--d-muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:2px}
.demo-card-value{font-size:1.8rem;font-weight:900;font-family:var(--d-font-data);color:var(--d-text);transition:color 0.3s}
.demo-card-unit{font-size:0.7rem;color:var(--d-muted);margin-left:4px}

/* --- SECTIONS --- */
.demo-section{margin:8px 12px;padding:12px;background:var(--d-card);border:1px solid var(--d-border);border-radius:8px}
.demo-section-title{font-size:0.75rem;font-weight:900;color:var(--d-accent);letter-spacing:2px;text-transform:uppercase;margin-bottom:8px;text-align:center}

/* --- MOST WANTED BOARD --- */
.demo-mw-board{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:8px}
.demo-mw-card{background:var(--d-dark);border:1px solid var(--d-border);border-radius:8px;padding:10px;text-align:center;transition:border-color 0.3s}
.demo-mw-card.rank-1{border-color:var(--d-accent);box-shadow:0 0 12px rgba(var(--d-accent-rgb),0.2)}
.demo-mw-card.rank-2,.demo-mw-card.rank-3{border-color:var(--d-secondary)}
.demo-mw-rank{font-size:0.6rem;font-weight:900;letter-spacing:1.5px;color:var(--d-danger);text-transform:uppercase}
.demo-mw-name{font-size:1rem;font-weight:900;color:var(--d-accent);margin:4px 0}
.demo-mw-stats{font-size:0.7rem;color:var(--d-muted);line-height:1.6}
.demo-mw-stats strong{color:var(--d-text)}
.demo-mw-threat{display:inline-block;font-size:0.55rem;font-weight:900;letter-spacing:1px;padding:2px 8px;border-radius:4px;margin-top:6px;text-transform:uppercase}
.demo-mw-threat.armed-dangerous{background:rgba(var(--d-danger,220,53,69),0.15);color:var(--d-danger);border:1px solid var(--d-danger)}
.demo-mw-threat.known-offender{background:rgba(var(--d-accent-rgb),0.1);color:var(--d-accent);border:1px solid rgba(var(--d-accent-rgb),0.3)}
.demo-mw-threat.person-of-interest{background:rgba(128,128,128,0.1);color:var(--d-muted);border:1px solid var(--d-border)}
.demo-mw-empty{text-align:center;color:var(--d-muted);font-size:0.8rem;padding:16px}

/* --- CASE FILE TABLE --- */
.demo-table{width:100%;border-collapse:collapse;font-size:0.72rem}
.demo-table th{font-weight:700;color:var(--d-accent);text-transform:uppercase;font-size:0.65rem;letter-spacing:0.5px;padding:6px 4px;border-bottom:2px solid var(--d-accent);text-align:left}
.demo-table td{padding:5px 4px;border-bottom:1px solid var(--d-border);color:var(--d-text);font-family:var(--d-font-data)}
.demo-table tr:last-child td{border-bottom:none}

/* --- VERSION BADGE --- */
.demo-version{text-align:center;padding:8px;font-size:0.6rem;color:var(--d-muted);letter-spacing:1px;border-top:1px solid var(--d-border)}

/* --- LEADERBOARD OVERLAY (inside demo) --- */
.demo-lb-overlay{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity 0.3s;z-index:10}
.demo-lb-overlay.show{opacity:1;pointer-events:auto}
.demo-lb-card{background:var(--d-card);border:2px solid var(--d-accent);border-radius:12px;padding:24px;text-align:center;max-width:300px;animation:demoLbPop 0.3s ease}
@keyframes demoLbPop{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}
.demo-lb-verdict{font-size:0.7rem;font-weight:900;letter-spacing:2px;color:var(--d-danger);text-transform:uppercase}
.demo-lb-rank{font-size:3rem;font-weight:900;color:var(--d-accent)}
.demo-lb-text{font-size:1.1rem;font-weight:900;color:var(--d-text);margin:4px 0}
.demo-lb-detail{font-size:0.75rem;color:var(--d-muted)}

/* === FEATURE 1: EVIDENCE TAG === */
.demo-ev-tag{position:absolute;bottom:60px;right:12px;z-index:9;animation:demoEvSlide 0.4s ease}
@keyframes demoEvSlide{from{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}
.demo-ev-tag-inner{background:var(--d-card);border:2px solid var(--d-accent);border-radius:10px;padding:0;overflow:hidden;width:280px;box-shadow:0 8px 32px rgba(0,0,0,0.5)}
.demo-ev-tag-header{display:flex;align-items:center;justify-content:space-between;padding:6px 10px;background:rgba(var(--d-accent-rgb),0.15);border-bottom:1px solid var(--d-accent)}
.demo-ev-tag-badge{font-size:0.55rem;font-weight:900;letter-spacing:2px;color:var(--d-accent);text-transform:uppercase}
.demo-ev-tag-close{background:none;border:none;color:var(--d-muted);font-size:1.2rem;cursor:pointer;padding:0 4px;line-height:1}
.demo-ev-tag-close:hover{color:var(--d-danger)}
.demo-ev-tag-body{padding:10px}
.demo-ev-tag-row{display:flex;gap:10px;align-items:center}
.demo-ev-tag-qr{width:64px;height:64px;flex-shrink:0;border-radius:4px;overflow:hidden;background:#fff;display:flex;align-items:center;justify-content:center}
.demo-ev-tag-qr svg{width:56px;height:56px}
.demo-ev-tag-info{flex:1;min-width:0}
.demo-ev-tag-case{font-size:1rem;font-weight:900;color:var(--d-accent);font-family:var(--d-font-data);letter-spacing:1px}
.demo-ev-tag-detail{font-size:0.7rem;color:var(--d-text);line-height:1.5;margin-top:2px}
.demo-ev-tag-meta{font-size:0.6rem;color:var(--d-muted);border-top:1px solid var(--d-border);margin-top:8px;padding-top:6px;text-align:center;font-family:var(--d-font-data)}

/* === FEATURE 2: SCIENCE FAIR STEPPER === */
.demo-sf-stepper{display:flex;align-items:center;justify-content:center;gap:0;padding:4px 8px;flex-wrap:wrap}
.demo-sf-step{display:flex;flex-direction:column;align-items:center;gap:2px;position:relative}
.demo-sf-dot{width:28px;height:28px;border-radius:50%;background:var(--d-dark);border:2px solid var(--d-border);display:flex;align-items:center;justify-content:center;font-size:0.65rem;font-weight:900;color:var(--d-muted);transition:all 0.3s}
.demo-sf-step.completed .demo-sf-dot{background:var(--d-success);border-color:var(--d-success);color:#fff}
.demo-sf-step.active .demo-sf-dot{background:rgba(var(--d-accent-rgb),0.2);border-color:var(--d-accent);color:var(--d-accent);box-shadow:0 0 12px rgba(var(--d-accent-rgb),0.4);animation:demoSfPulse 2s infinite}
@keyframes demoSfPulse{0%,100%{box-shadow:0 0 8px rgba(var(--d-accent-rgb),0.3)}50%{box-shadow:0 0 16px rgba(var(--d-accent-rgb),0.6)}}
.demo-sf-label{font-size:0.5rem;font-weight:700;color:var(--d-muted);text-transform:uppercase;letter-spacing:0.5px;white-space:nowrap}
.demo-sf-step.completed .demo-sf-label{color:var(--d-success)}
.demo-sf-step.active .demo-sf-label{color:var(--d-accent)}
.demo-sf-line{width:20px;height:2px;background:var(--d-border);margin:0 2px;margin-bottom:14px;transition:background 0.3s}
.demo-sf-line.completed{background:var(--d-success)}
.demo-sf-line.active{background:var(--d-accent);box-shadow:0 0 6px rgba(var(--d-accent-rgb),0.3)}
.demo-sf-info{padding:8px 12px;margin-top:8px}
.demo-sf-status{font-size:0.75rem;font-weight:900;color:var(--d-accent);letter-spacing:1px;text-transform:uppercase}
.demo-sf-desc{font-size:0.7rem;color:var(--d-muted);margin-top:2px}
.demo-sf-progress{margin-top:8px}
.demo-sf-bar-bg{height:6px;background:var(--d-dark);border-radius:3px;overflow:hidden;border:1px solid var(--d-border)}
.demo-sf-bar-fill{height:100%;background:linear-gradient(90deg,var(--d-accent),var(--d-success));border-radius:3px;transition:width 0.5s ease}
.demo-sf-bar-label{font-size:0.6rem;color:var(--d-muted);text-align:center;margin-top:3px;font-family:var(--d-font-data)}

/* === FEATURE 3: THE GARAGE === */
.demo-garage{display:grid;grid-template-columns:repeat(3,1fr);gap:6px}
@media(max-width:500px){.demo-garage{grid-template-columns:repeat(2,1fr)}}
.demo-garage-car{background:var(--d-dark);border:2px solid var(--d-border);border-radius:8px;padding:8px 6px;text-align:center;cursor:pointer;transition:all 0.2s;position:relative}
.demo-garage-car:hover{border-color:var(--d-secondary);transform:translateY(-1px)}
.demo-garage-car.selected{border-color:var(--d-accent);background:rgba(var(--d-accent-rgb),0.08);box-shadow:0 0 12px rgba(var(--d-accent-rgb),0.15)}
.demo-garage-car.selected::after{content:"NEXT";position:absolute;top:4px;right:4px;font-size:0.45rem;font-weight:900;background:var(--d-accent);color:var(--d-bg);padding:1px 5px;border-radius:3px;letter-spacing:1px}
.demo-garage-emoji{font-size:1.5rem;margin-bottom:2px}
.demo-garage-name{font-size:0.7rem;font-weight:900;color:var(--d-text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.demo-garage-weight{font-size:0.6rem;color:var(--d-muted);font-family:var(--d-font-data)}
.demo-garage-runs{font-size:0.55rem;color:var(--d-muted);margin-top:2px}
.demo-garage-best{font-size:0.55rem;color:var(--d-accent);font-family:var(--d-font-data);font-weight:700}
.demo-garage-hint{font-size:0.6rem;color:var(--d-muted);text-align:center;margin-top:6px;font-style:italic}

/* === FEATURE 4: FORMULA CARDS === */
.demo-grid-4{grid-template-columns:repeat(4,1fr)}
@media(max-width:600px){.demo-grid-4{grid-template-columns:repeat(2,1fr)}}
.demo-formula-card{background:var(--d-dark);border:1px solid var(--d-border);border-radius:8px;padding:10px 8px;text-align:center;transition:border-color 0.3s}
.demo-formula-card.highlight{border-color:var(--d-accent);box-shadow:0 0 8px rgba(var(--d-accent-rgb),0.15)}
.demo-formula-eq{font-size:1rem;font-weight:900;color:var(--d-accent);font-family:var(--d-font-data);margin-bottom:2px;letter-spacing:1px}
.demo-formula-name{font-size:0.55rem;font-weight:700;color:var(--d-muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:6px}
.demo-formula-val{font-size:0.95rem;font-weight:900;color:var(--d-text);font-family:var(--d-font-data)}
.demo-formula-work{font-size:0.55rem;color:var(--d-muted);font-family:var(--d-font-data);margin-top:3px;opacity:0.7}

/* === FEATURE 5: GHOST CAR === */
.demo-ghost{position:absolute;top:120px;left:12px;z-index:8;animation:demoGhostFade 0.5s ease}
@keyframes demoGhostFade{from{transform:translateX(-20px);opacity:0}to{transform:translateX(0);opacity:1}}
.demo-ghost-inner{background:var(--d-card);border:2px solid var(--d-border);border-radius:10px;padding:10px 14px;text-align:center;min-width:140px;box-shadow:0 4px 16px rgba(0,0,0,0.4)}
.demo-ghost-icon{font-size:1.4rem;margin-bottom:2px}
.demo-ghost-label{font-size:0.5rem;font-weight:900;color:var(--d-muted);letter-spacing:1.5px;text-transform:uppercase}
.demo-ghost-delta{font-size:1.3rem;font-weight:900;font-family:var(--d-font-data);margin:4px 0}
.demo-ghost-delta.faster{color:var(--d-success)}
.demo-ghost-delta.slower{color:var(--d-danger)}
.demo-ghost-delta.record{color:var(--d-accent);animation:demoRecordPulse 0.6s ease 3}
@keyframes demoRecordPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
.demo-ghost-detail{font-size:0.6rem;color:var(--d-muted);font-family:var(--d-font-data)}
</style>

<script>
/* =============================================================
   M.A.S.S. TRAP ‚Äî Live Dashboard Demo Simulation Engine
   ES5 compatible (var only, no let/const)
   ============================================================= */
(function() {
  'use strict';

  // ---- MOCK GARAGE ----
  var demoCars = [
    { name: 'F-150 Control', color: 'White', weight: 38.025, stats: { runs: 0, bestTime: null, bestSpeed: 0 } },
    { name: 'F-150 Test', color: 'Blue', weight: 31.546, stats: { runs: 0, bestTime: null, bestSpeed: 0 } },
    { name: 'Twin Mill', color: 'Chrome', weight: 42.300, stats: { runs: 0, bestTime: null, bestSpeed: 0 } },
    { name: 'Bone Shaker', color: 'Green', weight: 36.712, stats: { runs: 0, bestTime: null, bestSpeed: 0 } },
    { name: 'Rodger Dodger', color: 'Purple', weight: 40.150, stats: { runs: 0, bestTime: null, bestSpeed: 0 } },
    { name: 'Night Shifter', color: 'Black', weight: 35.880, stats: { runs: 0, bestTime: null, bestSpeed: 0 } }
  ];

  var demoState = 'IDLE';
  var demoRunCount = 0;
  var demoHistory = [];
  var demoCurrentCar = 0;
  var demoAutoTimer = null;
  var demoRaceTimer = null;
  var demoCountTimer = null;
  var demoTrackLength = 6.01;
  var MPS_TO_MPH = 2.23694;
  var demoTheme = 'interceptor';

  // Theme banner text (mirrors real firmware)
  var themeBannerText = {
    interceptor: { IDLE: 'AWAITING SUSPECTS', ARMED: 'TRAP SET', RACING: 'IN PURSUIT', FINISHED: 'SUSPECT CLOCKED' },
    classic:     { IDLE: 'READY TO RACE!', ARMED: 'ON YOUR MARKS...', RACING: 'GO GO GO!', FINISHED: 'FINISH LINE!' },
    daytona:     { IDLE: 'PIT LANE', ARMED: 'GREEN FLAG', RACING: 'FULL SEND', FINISHED: 'CHECKERED FLAG' },
    casefile:    { IDLE: 'CASE OPEN', ARMED: 'STAKEOUT ACTIVE', RACING: 'SUSPECT FLEEING', FINISHED: 'EVIDENCE LOGGED' },
    cyber:       { IDLE: 'SYSTEM IDLE', ARMED: 'ARMED // READY', RACING: 'TRACKING...', FINISHED: 'TARGET ACQUIRED' }
  };

  var themeHeaders = {
    interceptor: { title: 'M.A.S.S. TRAP', subtitle: 'MOTION ANALYSIS & SPEED SYSTEM', tagline: 'COMMAND CENTER' },
    classic:     { title: 'SPEED LAB', subtitle: 'REAL-TIME RACE TIMING SYSTEM', tagline: '' },
    daytona:     { title: 'M.A.S.S. TRAP', subtitle: 'MOTION ANALYSIS & SPEED SYSTEM', tagline: 'RACE CONTROL' },
    casefile:    { title: 'M.A.S.S. TRAP', subtitle: 'MOTION ANALYSIS & SPEED SYSTEM', tagline: 'COMMAND CENTER' },
    cyber:       { title: 'M.A.S.S. TRAP', subtitle: 'MOTION ANALYSIS & SPEED SYSTEM', tagline: 'COMMAND CENTER' }
  };

  var demoCaseNum = 0;
  var demoSfTotal = 20; // Science fair: 20 runs in matrix

  // Car emoji map (consistent display)
  var carEmoji = ['üèéÔ∏è', 'üöô', 'üîß', 'üíÄ', 'üèÅ', 'üåô'];

  function $(id) { return document.getElementById(id); }

  // ---- FEATURE 1: EVIDENCE TAG ----
  function demoGenerateQrSvg() {
    // Mini QR-like SVG pattern (cosmetic ‚Äî not scannable, just looks right)
    var size = 56;
    var cells = 11;
    var cell = size / cells;
    var rects = '';
    // Fixed finder patterns (top-left, top-right, bottom-left)
    var finders = [[0,0],[7,0],[0,7]];
    for (var f = 0; f < finders.length; f++) {
      var fx = finders[f][0], fy = finders[f][1];
      rects += '<rect x="' + (fx*cell) + '" y="' + (fy*cell) + '" width="' + (cell*3) + '" height="' + (cell*3) + '" fill="#000" rx="1"/>';
      rects += '<rect x="' + ((fx+0.5)*cell) + '" y="' + ((fy+0.5)*cell) + '" width="' + (cell*2) + '" height="' + (cell*2) + '" fill="#fff" rx="0.5"/>';
      rects += '<rect x="' + ((fx+1)*cell) + '" y="' + ((fy+1)*cell) + '" width="' + cell + '" height="' + cell + '" fill="#000" rx="0.5"/>';
    }
    // Random data cells
    for (var i = 0; i < cells; i++) {
      for (var j = 0; j < cells; j++) {
        if ((i < 3 && j < 3) || (i >= 7 && j < 3) || (i < 3 && j >= 7)) continue;
        if (Math.random() > 0.55) {
          rects += '<rect x="' + (i*cell) + '" y="' + (j*cell) + '" width="' + cell + '" height="' + cell + '" fill="#000"/>';
        }
      }
    }
    return '<svg viewBox="0 0 ' + size + ' ' + size + '" xmlns="http://www.w3.org/2000/svg">' + rects + '</svg>';
  }

  function demoShowEvTag(car, race, caseNumber) {
    var tag = $('demoEvTag');
    var now = new Date();
    var ts = now.getFullYear() + '-' +
      String(now.getMonth()+1).padStart(2,'0') + '-' +
      String(now.getDate()).padStart(2,'0') + ' ' +
      String(now.getHours()).padStart(2,'0') + ':' +
      String(now.getMinutes()).padStart(2,'0') + ':' +
      String(now.getSeconds()).padStart(2,'0');
    $('demoEvQr').innerHTML = demoGenerateQrSvg();
    $('demoEvCase').textContent = caseNumber;
    $('demoEvDetail').innerHTML = '<strong>' + car.name + '</strong><br>' +
      car.weight.toFixed(3) + 'g | ' + race.time.toFixed(3) + 's<br>' +
      race.mph.toFixed(1) + ' mph | ' + Math.round(race.scaleMph) + ' scale';
    $('demoEvMeta').textContent = ts + ' | DEMO-FINISH | Track: 6.01m';
    tag.style.display = '';
    // Auto-hide after 6s
    setTimeout(function() { tag.style.display = 'none'; }, 6000);
  }

  // ---- FEATURE 2: SCIENCE FAIR STEPPER ----
  function demoUpdateStepper() {
    var pct = Math.min(100, Math.round((demoRunCount / demoSfTotal) * 100));
    var bar = $('demoSfBar');
    var label = $('demoSfBarLabel');
    if (bar) bar.style.width = pct + '%';
    if (label) label.textContent = 'Run ' + Math.min(demoRunCount, demoSfTotal) + ' of ' + demoSfTotal;
    // If all runs done, advance stepper to phase 6
    if (demoRunCount >= demoSfTotal) {
      demoSetStepperPhase(6);
    }
  }

  function demoSetStepperPhase(phase) {
    var steps = document.querySelectorAll('#demoStepper .demo-sf-step');
    var lines = document.querySelectorAll('#demoStepper .demo-sf-line');
    var phaseNames = ['', 'EXPERIMENT SETUP', 'VEHICLE INTAKE', 'EVIDENCE PREP', 'PRE-FLIGHT CHECK', 'DATA COLLECTION', 'RESULTS & REPORT'];
    var phaseDescs = ['',
      'Define variables, pick template, set conditions.',
      'Select cars, verify weights, check NFC tags.',
      'Assign case numbers, print tags, photograph setup.',
      'Review test plan, readiness checklist, confirm.',
      'Collecting race data with sanity checks. Auto-advancing through test matrix.',
      'All tests complete! Review summary, export CSV, generate science fair report.'
    ];
    for (var i = 0; i < steps.length; i++) {
      var p = parseInt(steps[i].getAttribute('data-phase'));
      steps[i].className = 'demo-sf-step' + (p < phase ? ' completed' : p === phase ? ' active' : '');
      var dot = steps[i].querySelector('.demo-sf-dot');
      if (p < phase) dot.innerHTML = '&#10003;';
      else dot.textContent = p;
    }
    for (var j = 0; j < lines.length; j++) {
      var linePhase = j + 2;
      lines[j].className = 'demo-sf-line' + (linePhase <= phase ? ' completed' : linePhase === phase + 1 ? ' active' : '');
    }
    var info = $('demoSfInfo');
    if (info) {
      info.querySelector('.demo-sf-status').innerHTML = '&#9654; PHASE ' + phase + ': ' + (phaseNames[phase] || '');
      info.querySelector('.demo-sf-desc').textContent = phaseDescs[phase] || '';
    }
  }

  // ---- FEATURE 3: THE GARAGE ----
  function demoRenderGarage() {
    var garage = $('demoGarage');
    if (!garage) return;
    garage.innerHTML = demoCars.map(function(car, i) {
      var sel = i === demoCurrentCar ? ' selected' : '';
      var best = car.stats.bestTime ? car.stats.bestTime.toFixed(3) + 's' : '--';
      return '<div class="demo-garage-car' + sel + '" onclick="demoSelectCar(' + i + ')">' +
        '<div class="demo-garage-emoji">' + carEmoji[i] + '</div>' +
        '<div class="demo-garage-name">' + car.name + '</div>' +
        '<div class="demo-garage-weight">' + car.weight.toFixed(1) + 'g</div>' +
        '<div class="demo-garage-runs">' + car.stats.runs + ' runs</div>' +
        '<div class="demo-garage-best">Best: ' + best + '</div>' +
      '</div>';
    }).join('');
  }

  // ---- FEATURE 4: FORMULA CARDS ----
  function demoUpdateFormulas(time, speedMps, weight) {
    var mass_kg = weight / 1000;
    var momentum = mass_kg * speedMps;
    var ke = 0.5 * mass_kg * speedMps * speedMps;
    var acc = speedMps / time;

    $('demoFVel').textContent = speedMps.toFixed(2) + ' m/s';
    $('demoFVelWork').textContent = '6.01m \u00F7 ' + time.toFixed(3) + 's';

    $('demoFMom').textContent = momentum.toFixed(4) + ' kg\u00B7m/s';
    $('demoFMomWork').textContent = mass_kg.toFixed(4) + 'kg \u00D7 ' + speedMps.toFixed(2) + 'm/s';

    $('demoFKE').textContent = ke.toFixed(5) + ' J';
    $('demoFKEWork').textContent = '\u00BD \u00D7 ' + mass_kg.toFixed(4) + 'kg \u00D7 ' + speedMps.toFixed(2) + '\u00B2';

    $('demoFAcc').textContent = acc.toFixed(2) + ' m/s\u00B2';
    $('demoFAccWork').textContent = speedMps.toFixed(2) + 'm/s \u00F7 ' + time.toFixed(3) + 's';

    // Flash highlight
    var cards = document.querySelectorAll('.demo-formula-card');
    for (var i = 0; i < cards.length; i++) {
      cards[i].classList.add('highlight');
    }
    setTimeout(function() {
      for (var j = 0; j < cards.length; j++) {
        cards[j].classList.remove('highlight');
      }
    }, 2000);
  }

  // ---- FEATURE 5: GHOST CAR ----
  function demoShowGhost(car, currentTime) {
    var ghost = $('demoGhost');
    if (!ghost) return;
    // Need at least one previous run for this car
    if (car.stats.runs < 2 && car.stats.bestTime === currentTime) {
      // First run for this car ‚Äî show "FIRST RUN!"
      ghost.style.display = '';
      $('demoGhostIcon').textContent = '\uD83C\uDFC6'; // trophy
      $('demoGhostDelta').textContent = 'FIRST RUN!';
      $('demoGhostDelta').className = 'demo-ghost-delta record';
      $('demoGhostDetail').textContent = currentTime.toFixed(3) + 's ‚Äî new benchmark';
      setTimeout(function() { ghost.style.display = 'none'; }, 5000);
      return;
    }
    var prevBest = car.stats.prevBest || car.stats.bestTime;
    if (prevBest == null) return;
    var delta = currentTime - prevBest;
    ghost.style.display = '';
    if (delta < -0.001) {
      // New record!
      $('demoGhostIcon').textContent = '\uD83C\uDFC6'; // trophy
      $('demoGhostDelta').textContent = delta.toFixed(3) + 's';
      $('demoGhostDelta').className = 'demo-ghost-delta record';
      $('demoGhostDetail').textContent = 'NEW RECORD! Was ' + prevBest.toFixed(3) + 's';
    } else if (delta > 0.001) {
      // Slower
      $('demoGhostIcon').textContent = '\uD83D\uDC7B'; // ghost
      $('demoGhostDelta').textContent = '+' + delta.toFixed(3) + 's';
      $('demoGhostDelta').className = 'demo-ghost-delta slower';
      $('demoGhostDetail').textContent = 'Best: ' + prevBest.toFixed(3) + 's';
    } else {
      // Tied
      $('demoGhostIcon').textContent = '\uD83E\uDD1D'; // handshake
      $('demoGhostDelta').textContent = 'TIED!';
      $('demoGhostDelta').className = 'demo-ghost-delta faster';
      $('demoGhostDetail').textContent = 'Matched ' + prevBest.toFixed(3) + 's';
    }
    setTimeout(function() { ghost.style.display = 'none'; }, 5000);
  }

  function updateBanner() {
    var banner = $('demoBanner');
    var texts = themeBannerText[demoTheme] || themeBannerText.interceptor;
    var stateText = texts[demoState] || demoState;
    var car = demoCars[demoCurrentCar];
    banner.className = 'demo-state-banner ' + demoState.toLowerCase();
    banner.textContent = car.name.toUpperCase() + ' \u2014 ' + stateText;
    $('demoLed').className = 'demo-led-bar ' + demoState.toLowerCase();
  }

  function clearStats() {
    $('demoTime').textContent = '--';
    $('demoSpeed').textContent = '--';
    $('demoScale').textContent = '--';
    $('demoMomentum').textContent = '--';
    $('demoKE').textContent = '--';
  }

  function showStats(time, speedMps, weight) {
    var mph = speedMps * MPS_TO_MPH;
    var scaleMph = mph * 64;
    var mass_kg = weight / 1000;
    var momentum = mass_kg * speedMps;
    var ke = 0.5 * mass_kg * speedMps * speedMps;
    $('demoTime').textContent = time.toFixed(3);
    $('demoSpeed').textContent = mph.toFixed(1);
    $('demoScale').textContent = Math.round(scaleMph);
    $('demoMomentum').textContent = momentum.toFixed(4);
    $('demoKE').textContent = ke.toFixed(4);
    $('demoRuns').textContent = demoRunCount;
    return { time: time, mph: mph, scaleMph: scaleMph, momentum: momentum, ke: ke, speedMps: speedMps };
  }

  function addToHistory(car, race) {
    demoHistory.unshift({ car: car.name, weight: car.weight, time: race.time, mph: race.mph, scaleMph: race.scaleMph, momentum: race.momentum, ke: race.ke });
    if (demoHistory.length > 8) demoHistory.pop();
    var tbody = $('demoHistory');
    tbody.innerHTML = demoHistory.map(function(h, i) {
      return '<tr>' +
        '<td>' + (demoRunCount - i) + '</td>' +
        '<td>' + h.car + '</td>' +
        '<td>' + h.weight.toFixed(1) + 'g</td>' +
        '<td>' + h.time.toFixed(3) + '</td>' +
        '<td>' + h.mph.toFixed(1) + '</td>' +
        '<td>' + Math.round(h.scaleMph) + '</td>' +
        '<td>' + h.momentum.toFixed(4) + '</td>' +
        '<td>' + h.ke.toFixed(4) + '</td>' +
        '</tr>';
    }).join('');
  }

  function renderMostWanted() {
    var board = $('demoMW');
    var data = demoCars.filter(function(c) { return c.stats.runs > 0; })
      .sort(function(a, b) {
        if (a.stats.bestTime == null) return 1;
        if (b.stats.bestTime == null) return -1;
        return a.stats.bestTime - b.stats.bestTime;
      });
    if (data.length === 0) {
      board.innerHTML = '<div class="demo-mw-empty">No suspects in the system. Watch the demo cycle or click ARM to run a race.</div>';
      return;
    }
    board.innerHTML = data.map(function(car, i) {
      var rank = i + 1;
      var rankClass = rank <= 3 ? ' rank-' + rank : '';
      var rankTitle = rank === 1 ? 'PUBLIC ENEMY #1' : rank <= 3 ? 'MOST WANTED' : 'APB #' + rank;
      var threatCls = rank <= 3 ? 'armed-dangerous' : rank <= Math.max(5, Math.ceil(data.length * 0.5)) ? 'known-offender' : 'person-of-interest';
      var threatText = rank <= 3 ? 'ARMED & DANGEROUS' : threatCls === 'known-offender' ? 'KNOWN OFFENDER' : 'PERSON OF INTEREST';
      var bestMph = car.stats.bestSpeed ? (car.stats.bestSpeed * MPS_TO_MPH).toFixed(1) : '--';
      var bestScale = car.stats.bestSpeed ? Math.round(car.stats.bestSpeed * MPS_TO_MPH * 64) : '--';
      return '<div class="demo-mw-card' + rankClass + '">' +
        '<div class="demo-mw-rank">' + rankTitle + '</div>' +
        '<div class="demo-mw-name">' + car.name + '</div>' +
        '<div class="demo-mw-stats">' +
          'Time: <strong>' + (car.stats.bestTime ? car.stats.bestTime.toFixed(3) + 's' : '--') + '</strong><br>' +
          'Speed: <strong>' + bestMph + ' mph</strong><br>' +
          'Scale: <strong>' + bestScale + ' mph</strong><br>' +
          'Mass: <strong>' + car.weight + 'g</strong><br>' +
          'Offenses: <strong>' + car.stats.runs + '</strong>' +
        '</div>' +
        '<div class="demo-mw-threat ' + threatCls + '">' + threatText + '</div>' +
      '</div>';
    }).join('');
  }

  function showLeaderboard(car, race, rank) {
    var overlay = $('demoLbOverlay');
    if (!overlay) return;
    var verdicts = ['', 'ALL POINTS BULLETIN', 'WARRANT ISSUED', 'SUSPECT IDENTIFIED'];
    var msgs = ['', 'PUBLIC ENEMY #1', 'MOST WANTED #2', 'MOST WANTED #3'];
    overlay.querySelector('.demo-lb-verdict').textContent = verdicts[Math.min(rank, 3)] || 'BOOKING REPORT';
    overlay.querySelector('.demo-lb-rank').textContent = '#' + rank;
    overlay.querySelector('.demo-lb-text').textContent = msgs[Math.min(rank, 3)] || 'KNOWN OFFENDER #' + rank;
    overlay.querySelector('.demo-lb-detail').textContent = car.name + ' | ' + race.time.toFixed(3) + 's | ' + Math.round(race.scaleMph) + ' scale mph';
    overlay.classList.add('show');
    setTimeout(function() { overlay.classList.remove('show'); }, 3500);
  }

  // ---- RACE SIMULATION ----
  function simulateRace() {
    if (demoState !== 'IDLE') return;
    // ARM
    demoState = 'ARMED';
    updateBanner();
    $('demoBtnArm').disabled = true;
    $('demoBtnArm').textContent = 'ARMED';
    clearStats();

    // After 1.5s, start RACING
    demoRaceTimer = setTimeout(function() {
      demoState = 'RACING';
      updateBanner();
      $('demoBtnArm').textContent = 'RACING';

      // Running timer animation
      var raceStart = Date.now();
      var car = demoCars[demoCurrentCar];
      // Realistic times: lighter cars tend faster, range 1.2-2.8s on 6m track
      var baseTime = 1.5 + (car.weight - 30) * 0.03;
      var targetTime = baseTime + (Math.random() * 0.6 - 0.3);
      targetTime = Math.max(1.2, Math.min(2.8, targetTime));

      demoCountTimer = setInterval(function() {
        var elapsed = (Date.now() - raceStart) / 1000;
        $('demoTime').textContent = elapsed.toFixed(3);
      }, 50);

      // FINISH after simulated time
      var raceDuration = Math.max(800, targetTime * 400);
      demoRaceTimer = setTimeout(function() {
        clearInterval(demoCountTimer);
        demoState = 'FINISHED';
        demoRunCount++;
        updateBanner();
        $('demoBtnArm').textContent = 'FINISHED';

        var speedMps = demoTrackLength / targetTime;
        var race = showStats(targetTime, speedMps, car.weight);

        // Save previous best BEFORE updating (for ghost car)
        car.stats.prevBest = car.stats.bestTime;

        // Update car stats
        car.stats.runs++;
        if (car.stats.bestTime == null || targetTime < car.stats.bestTime) {
          car.stats.bestTime = targetTime;
        }
        if (speedMps > car.stats.bestSpeed) {
          car.stats.bestSpeed = speedMps;
        }

        addToHistory(car, race);
        renderMostWanted();

        // === FEATURE 1: Evidence Tag ===
        demoCaseNum++;
        var caseStr = 'MASS26-' + String(demoCaseNum).padStart(4, '0');
        demoShowEvTag(car, race, caseStr);

        // === FEATURE 2: Science Fair Stepper ===
        demoUpdateStepper();

        // === FEATURE 3: Garage (update stats) ===
        demoRenderGarage();

        // === FEATURE 4: Formula Cards ===
        demoUpdateFormulas(targetTime, speedMps, car.weight);

        // === FEATURE 5: Ghost Car Comparison ===
        demoShowGhost(car, targetTime);

        // Find rank
        var ranked = demoCars.filter(function(c) { return c.stats.bestTime != null; })
          .sort(function(a, b) { return a.stats.bestTime - b.stats.bestTime; });
        var rank = 1;
        for (var r = 0; r < ranked.length; r++) {
          if (ranked[r].name === car.name) { rank = r + 1; break; }
        }
        if (ranked.length >= 2) showLeaderboard(car, race, rank);

        // Auto-reset after 4s
        demoRaceTimer = setTimeout(function() {
          demoState = 'IDLE';
          demoCurrentCar = (demoCurrentCar + 1) % demoCars.length;
          updateBanner();
          $('demoBtnArm').disabled = false;
          $('demoBtnArm').textContent = 'ARM SYSTEM';
        }, 4000);

      }, raceDuration);
    }, 1500);
  }

  // ---- PUBLIC API (on window for onclick) ----
  window.demoArm = function() {
    if (demoState === 'IDLE') {
      clearTimeout(demoAutoTimer);
      simulateRace();
      // Re-schedule auto after this race completes
      demoAutoTimer = setTimeout(function autoLoop() {
        simulateRace();
        demoAutoTimer = setTimeout(autoLoop, 9000);
      }, 12000);
    }
  };

  window.demoReset = function() {
    clearTimeout(demoRaceTimer);
    clearTimeout(demoAutoTimer);
    clearInterval(demoCountTimer);
    demoState = 'IDLE';
    updateBanner();
    clearStats();
    $('demoBtnArm').disabled = false;
    $('demoBtnArm').textContent = 'ARM SYSTEM';
    var overlay = $('demoLbOverlay');
    if (overlay) overlay.classList.remove('show');
    // Restart auto-cycle
    demoAutoTimer = setTimeout(function autoLoop() {
      simulateRace();
      demoAutoTimer = setTimeout(autoLoop, 9000);
    }, 5000);
  };

  window.demoSync = function() {
    var conn = $('demoConn');
    conn.textContent = 'SYNCING...';
    conn.className = 'demo-conn connected';
    setTimeout(function() {
      conn.textContent = 'LINKED';
    }, 1000);
  };

  window.demoSelectCar = function(index) {
    if (demoState !== 'IDLE') return; // Can't switch mid-race
    demoCurrentCar = index;
    demoRenderGarage();
    updateBanner();
    // Reset auto-timer so selected car runs next
    clearTimeout(demoAutoTimer);
    demoAutoTimer = setTimeout(function autoLoop() {
      simulateRace();
      demoAutoTimer = setTimeout(autoLoop, 9000);
    }, 3000);
  };

  window.demoCloseTag = function() {
    var tag = $('demoEvTag');
    if (tag) tag.style.display = 'none';
  };

  window.demoSetTheme = function(theme) {
    demoTheme = theme;
    $('demoFrame').setAttribute('data-theme', theme);
    var hdr = themeHeaders[theme] || themeHeaders.interceptor;
    $('demoTitle').textContent = hdr.title;
    $('demoSubtitle').textContent = hdr.subtitle;
    $('demoTagline').textContent = hdr.tagline;
    $('demoTagline').style.display = hdr.tagline ? '' : 'none';
    updateBanner();
  };

  // ---- INIT: Add leaderboard overlay to DOM ----
  function initDemo() {
    var frame = $('demoFrame');
    var lbHtml = '<div id="demoLbOverlay" class="demo-lb-overlay">' +
      '<div class="demo-lb-card">' +
        '<div class="demo-lb-verdict"></div>' +
        '<div class="demo-lb-rank">#1</div>' +
        '<div class="demo-lb-text"></div>' +
        '<div class="demo-lb-detail"></div>' +
      '</div>' +
    '</div>';
    frame.insertAdjacentHTML('beforeend', lbHtml);

    updateBanner();
    $('demoRuns').textContent = '0';

    // Init Feature 2: Science Fair Stepper (Phase 5 active)
    demoSetStepperPhase(5);

    // Init Feature 3: Garage
    demoRenderGarage();

    // Start auto-race cycle after 3s (give user time to see the idle state)
    demoAutoTimer = setTimeout(function autoLoop() {
      simulateRace();
      demoAutoTimer = setTimeout(autoLoop, 9000);
    }, 3000);
  }

  // Start when DOM ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initDemo);
  } else {
    initDemo();
  }
})();
</script>

<!-- ==================== BUILD TIERS ==================== -->
<div class="section" id="build">
  <div class="container">
    <div class="section-header">
      <h2>Build Your Own</h2>
      <p>Pick your budget. Get the parts. Flash the firmware. Race.</p>
    </div>
    <div class="tiers-grid">

      <!-- Tier 1: Starter -->
      <div class="tier-card">
        <div class="tier-header">
          <div class="tier-name">Starter Track</div>
          <div class="tier-price">~$25 <span>estimated</span></div>
          <div class="tier-desc">Minimum viable speed trap</div>
        </div>
        <div class="tier-body">
          <ul class="tier-list">
            <li><strong>ESP32-S3-WROOM-1 N16R8</strong> &mdash; the brain ($7)</li>
            <li><strong>2x IR break-beam sensors</strong> &mdash; start + finish detection ($4)</li>
            <li><strong>Breadboard + jumper wires</strong> &mdash; no soldering needed ($5)</li>
            <li><strong>USB-C cable + power</strong> &mdash; phone charger works ($3)</li>
            <li><strong>Hot Wheels track + car</strong> &mdash; any track, any car ($6)</li>
            <li>WiFi dashboard with timing and speed</li>
            <li>CSV data export for science fair</li>
          </ul>
        </div>
        <div class="tier-footer">
          <a href="store.html#starter" class="btn btn-outline" style="width:100%;justify-content:center">View Parts List</a>
        </div>
      </div>

      <!-- Tier 2: Science Fair (Recommended) -->
      <div class="tier-card recommended">
        <div class="tier-header">
          <div class="tier-badge">Ryan Recommends</div>
          <div class="tier-name">Science Fair Ready</div>
          <div class="tier-price">~$60 <span>estimated</span></div>
          <div class="tier-desc">Everything Ben used for his project</div>
        </div>
        <div class="tier-body">
          <ul class="tier-list">
            <li><strong>Everything in Starter</strong>, plus:</li>
            <li><strong>Milligram scale</strong> &mdash; weigh cars to &plusmn;0.001g ($12)</li>
            <li><strong>NTAG213 NFC stickers</strong> &mdash; scan car, auto-select ($5/50pk)</li>
            <li><strong>Tungsten weight set</strong> &mdash; add mass for experiments ($10)</li>
            <li><strong>MAX98357A I2S amplifier</strong> &mdash; audio announcer ($4)</li>
            <li><strong>Small speaker</strong> &mdash; 3W, 4 ohm ($3)</li>
            <li>Evidence tags with QR codes</li>
            <li>Auto-generated science fair report</li>
            <li>Guided 6-phase testing workflow</li>
          </ul>
        </div>
        <div class="tier-footer">
          <a href="store.html#science-fair" class="btn btn-gold" style="width:100%;justify-content:center">View Parts List</a>
        </div>
      </div>

      <!-- Tier 3: Full Send -->
      <div class="tier-card">
        <div class="tier-header">
          <div class="tier-name">Full Send</div>
          <div class="tier-price">~$120 <span>estimated</span></div>
          <div class="tier-desc">The "it's 3am and I can't stop" build</div>
        </div>
        <div class="tier-body">
          <ul class="tier-list">
            <li><strong>Everything in Science Fair</strong>, plus:</li>
            <li><strong>2nd ESP32</strong> &mdash; dedicated start gate ($7)</li>
            <li><strong>3rd ESP32</strong> &mdash; mid-track speed trap ($7)</li>
            <li><strong>TF-Luna LiDAR</strong> &mdash; auto-detect cars at start ($12)</li>
            <li><strong>BTF WS2812B LED strip</strong> &mdash; 1000 LEDs of drama ($20)</li>
            <li><strong>WLED controller</strong> &mdash; separate ESP32 for lights ($7)</li>
            <li>3-device ESP-NOW mesh network</li>
            <li>LiDAR auto-arm (hands-free operation)</li>
            <li>Synchronized LED race animations</li>
            <li>Mid-track velocity measurement</li>
          </ul>
        </div>
        <div class="tier-footer">
          <a href="store.html#full-send" class="btn btn-outline" style="width:100%;justify-content:center">View Parts List</a>
        </div>
      </div>
    </div>

    <div class="affiliate-notice">
      Links to Amazon and other retailers may include affiliate tags. This costs you nothing extra and helps support the project.
      We only recommend parts we've actually used and tested. No sponsorships. No bullshit.
    </div>
  </div>
</div>

<!-- ==================== BUILD WIZARD (Coming Soon) ==================== -->
<div class="section" id="wizard">
  <div class="container">
    <div class="section-header">
      <h2>Build Wizard</h2>
      <p>Tell us what you want to build. We'll tell you exactly how to wire it.</p>
    </div>
    <div class="coming-soon">
      <div class="emoji">&#128268;</div>
      <h3>Interactive Build Wizard &mdash; Coming Soon</h3>
      <p>
        Pick your loadout. See a color-coded pinout diagram showing <strong>exactly</strong> which wire goes where.
        No schematic reading required. No electronics experience needed.
        Then plug in your ESP32 and flash the firmware right from your browser.
      </p>
      <div style="margin-top:24px;display:flex;gap:12px;justify-content:center;flex-wrap:wrap">
        <div style="background:var(--gold-glow);border:1px solid var(--gold-dim);border-radius:8px;padding:12px 16px;font-size:0.82rem;color:var(--text-muted)">
          <strong style="color:var(--gold)">Step 1:</strong> Pick your tier &amp; options
        </div>
        <div style="background:var(--gold-glow);border:1px solid var(--gold-dim);border-radius:8px;padding:12px 16px;font-size:0.82rem;color:var(--text-muted)">
          <strong style="color:var(--gold)">Step 2:</strong> See your custom wiring diagram
        </div>
        <div style="background:var(--gold-glow);border:1px solid var(--gold-dim);border-radius:8px;padding:12px 16px;font-size:0.82rem;color:var(--text-muted)">
          <strong style="color:var(--gold)">Step 3:</strong> Flash firmware from your browser
        </div>
      </div>
    </div>

    <div class="tip-bubble" style="max-width:700px;margin:32px auto 0">
      <div class="tip-label">Did You Know?</div>
      <strong>Galileo proved that all objects fall at the same rate in a vacuum in 1589.</strong>
      But on a real track with friction and air resistance, heavier objects have more momentum to push through.
      That's exactly what M.A.S.S. Trap measures &mdash; <em>the difference between theory and reality</em>.
    </div>
  </div>
</div>

<!-- ==================== WEB FLASHER (Coming Soon) ==================== -->
<div class="section" id="flash">
  <div class="container">
    <div class="section-header">
      <h2>Browser Flasher</h2>
      <p>No software to install. No command line. Just plug in and click.</p>
    </div>
    <div class="coming-soon">
      <div class="emoji">&#9889;</div>
      <h3>ESP Web Flasher &mdash; Coming Soon</h3>
      <p>
        Using <a href="https://esphome.github.io/esp-web-tools/" target="_blank">ESP Web Tools</a>,
        you'll be able to flash M.A.S.S. Trap firmware directly from this page.
        Select your build configuration, connect your ESP32 via USB, click Flash. Done.
        <strong>Works in Chrome and Edge.</strong>
      </p>
    </div>
  </div>
</div>

<!-- ==================== ROADMAP ==================== -->
<div class="section" id="roadmap">
  <div class="container">
    <div class="section-header">
      <h2>Project Roadmap</h2>
      <p>What's built, what's next, and what's cooking at 3am.</p>
    </div>
    <div class="roadmap">
      <div class="roadmap-item">
        <div class="roadmap-status done">&#10003;</div>
        <div>
          <h4>Core Race Timing</h4>
          <p>Microsecond ISR timing, physics calculations, CSV logging, web dashboard</p>
        </div>
      </div>
      <div class="roadmap-item">
        <div class="roadmap-status done">&#10003;</div>
        <div>
          <h4>ESP-NOW Mesh Network</h4>
          <p>3-device communication: start gate, finish gate, speed trap. Auto-discovery and clock sync.</p>
        </div>
      </div>
      <div class="roadmap-item">
        <div class="roadmap-status done">&#10003;</div>
        <div>
          <h4>Evidence System + NFC</h4>
          <p>Case numbers, QR evidence tags, NFC stickers for car ID, printable labels, chain of custody.</p>
        </div>
      </div>
      <div class="roadmap-item">
        <div class="roadmap-status done">&#10003;</div>
        <div>
          <h4>Science Fair Playlist Mode</h4>
          <p>6-phase guided workflow: experiment setup, vehicle intake, evidence prep, pre-flight, data collection, report.</p>
        </div>
      </div>
      <div class="roadmap-item">
        <div class="roadmap-status done">&#10003;</div>
        <div>
          <h4>Browser Firmware Update</h4>
          <p>OTA updates from GitHub with MD5 verification. No cables after first flash.</p>
        </div>
      </div>
      <div class="roadmap-item">
        <div class="roadmap-status done">&#10003;</div>
        <div>
          <h4>Audio Announcer + WLED</h4>
          <p>I2S audio playback, race result announcements. WLED integration for LED animations.</p>
        </div>
      </div>
      <div class="roadmap-item">
        <div class="roadmap-status wip">&#9881;</div>
        <div>
          <h4>Interactive Build Wizard</h4>
          <p>Pick your config, see wiring diagrams, flash from browser. Zero anxiety onboarding.</p>
        </div>
      </div>
      <div class="roadmap-item">
        <div class="roadmap-status wip">&#9881;</div>
        <div>
          <h4>Parts Store + Affiliate Links</h4>
          <p>Curated component lists by budget tier with current Amazon pricing.</p>
        </div>
      </div>
      <div class="roadmap-item">
        <div class="roadmap-status planned">&#9734;</div>
        <div>
          <h4>Drag Tree Start Gate</h4>
          <p>Christmas tree countdown lights + servo-controlled launch gate. Full drag strip experience.</p>
        </div>
      </div>
      <div class="roadmap-item">
        <div class="roadmap-status planned">&#9734;</div>
        <div>
          <h4>Onboard Telemetry</h4>
          <p>XIAO ESP32-S3 + accelerometer strapped to a Hot Wheels car. G-force, vibration, real-time radio.</p>
        </div>
      </div>
      <div class="roadmap-item">
        <div class="roadmap-status planned">&#9734;</div>
        <div>
          <h4>LTI Integration</h4>
          <p>Connect to Moodle/Canvas as an external tool. Auto-submit science fair data for grading. $7 board does what $10K LMS can't.</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ==================== QUOTE ==================== -->
<div class="section">
  <div class="container">
    <div class="quote-block">
      <blockquote>
        &ldquo;This project was built at kitchen tables and workbenches between the hours of midnight and sunrise.
        A dad, his two sons, and an AI &mdash; proving that the best tools in the world are worthless
        without the people willing to stay up all night using them.&rdquo;
      </blockquote>
      <cite>&mdash; The Kristina Report&trade;</cite>
    </div>
  </div>
</div>

<!-- ==================== FOOTER ==================== -->
<footer class="site-footer">
  <div class="container">
    <div class="footer-links">
      <a href="https://github.com/Ryan4n6/MASS-Trap" target="_blank">GitHub</a>
      <a href="https://github.com/Ryan4n6/MASS-Trap/releases" target="_blank">Releases</a>
      <a href="store.html">Parts Store</a>
      <a href="https://github.com/Ryan4n6/MASS-Trap/wiki" target="_blank">Documentation</a>
      <a href="https://github.com/Ryan4n6/MASS-Trap/issues" target="_blank">Report a Bug</a>
    </div>
    <div class="footer-copy">
      M.A.S.S. Trap &copy; 2026 <a href="https://github.com/Ryan4n6" target="_blank">Ryan Massfeller</a>.
      Open source under the MIT License.
      <br>Built with ESP32, Hot Wheels, and an unreasonable amount of caffeine.
    </div>
  </div>
</footer>

</body>
</html>
